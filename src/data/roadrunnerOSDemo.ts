import type {
  AppointmentRecord,
  CallEvent,
  ConsentEvent,
  ConversationThread,
  FinanceApplicationRecord,
  LeadLifecycleRecord,
  MessageEvent,
  OpportunityRecord,
  ReviewRequestRecord,
  WorkflowDefinition,
  WorkflowRun,
} from '../types/roadrunnerOS';

function isoMinutesAgo(minutes: number): string {
  return new Date(Date.now() - minutes * 60_000).toISOString();
}

function isoHoursAgo(hours: number): string {
  return new Date(Date.now() - hours * 3_600_000).toISOString();
}

function isoDaysAgo(days: number): string {
  return new Date(Date.now() - days * 86_400_000).toISOString();
}

function isoHoursAhead(hours: number): string {
  return new Date(Date.now() + hours * 3_600_000).toISOString();
}

export const osLeads: LeadLifecycleRecord[] = [
  {
    id: 'lead-os-1',
    first_name: 'Sarah',
    last_name: 'Johnson',
    email: 'sarah.johnson@email.com',
    phone: '734-555-2001',
    source: 'website_form',
    status: 'new',
    urgency: 'high',
    lead_score: 96,
    created_at: isoMinutesAgo(23),
    first_contact_at: null,
    last_contact_at: null,
    budget_max: 23000,
    has_trade_in: false,
    location_intent: 'wayne',
  },
  {
    id: 'lead-os-2',
    first_name: 'Robert',
    last_name: 'Chen',
    email: 'rchen@gmail.com',
    phone: '734-555-2002',
    source: 'phone',
    status: 'contacted',
    urgency: 'high',
    lead_score: 89,
    created_at: isoHoursAgo(5),
    first_contact_at: isoHoursAgo(4.8),
    last_contact_at: isoHoursAgo(2.1),
    budget_max: 35000,
    has_trade_in: true,
    location_intent: 'taylor',
  },
  {
    id: 'lead-os-3',
    first_name: 'Jessica',
    last_name: 'Williams',
    email: 'j.williams@outlook.com',
    phone: '734-555-2003',
    source: 'facebook',
    status: 'appointment_set',
    urgency: 'high',
    lead_score: 91,
    created_at: isoDaysAgo(1),
    first_contact_at: isoDaysAgo(1),
    last_contact_at: isoHoursAgo(10),
    budget_max: 27000,
    has_trade_in: false,
    location_intent: 'wayne',
  },
  {
    id: 'lead-os-4',
    first_name: 'Michael',
    last_name: 'Davis',
    email: 'mdavis@yahoo.com',
    phone: '734-555-2004',
    source: 'website_form',
    status: 'appointment_showed',
    urgency: 'medium',
    lead_score: 78,
    created_at: isoDaysAgo(2),
    first_contact_at: isoDaysAgo(2),
    last_contact_at: isoHoursAgo(12),
    budget_max: 22000,
    has_trade_in: false,
    location_intent: 'taylor',
  },
  {
    id: 'lead-os-5',
    first_name: 'Emily',
    last_name: 'Martinez',
    email: 'emily.m@gmail.com',
    phone: '734-555-2005',
    source: 'website_form',
    status: 'financing_review',
    urgency: 'medium',
    lead_score: 76,
    created_at: isoDaysAgo(4),
    first_contact_at: isoDaysAgo(4),
    last_contact_at: isoHoursAgo(19),
    budget_max: 15000,
    has_trade_in: false,
    location_intent: 'wayne',
  },
  {
    id: 'lead-os-6',
    first_name: 'David',
    last_name: 'Thompson',
    email: 'dthompson@email.com',
    phone: '734-555-2006',
    source: 'phone',
    status: 'negotiating',
    urgency: 'medium',
    lead_score: 84,
    created_at: isoDaysAgo(3),
    first_contact_at: isoDaysAgo(3),
    last_contact_at: isoHoursAgo(27),
    budget_max: 32000,
    has_trade_in: true,
    location_intent: 'taylor',
  },
  {
    id: 'lead-os-7',
    first_name: 'Jennifer',
    last_name: 'Brown',
    email: 'jbrown@gmail.com',
    phone: '734-555-2008',
    source: 'website_form',
    status: 'closed_won',
    urgency: 'medium',
    lead_score: 86,
    created_at: isoDaysAgo(20),
    first_contact_at: isoDaysAgo(20),
    last_contact_at: isoDaysAgo(2),
    budget_max: 28000,
    has_trade_in: true,
    location_intent: 'wayne',
  },
  {
    id: 'lead-os-8',
    first_name: 'William',
    last_name: 'Anderson',
    email: 'w.anderson@email.com',
    phone: '734-555-2010',
    source: 'website_form',
    status: 'closed_lost',
    urgency: 'low',
    lead_score: 66,
    created_at: isoDaysAgo(16),
    first_contact_at: isoDaysAgo(16),
    last_contact_at: isoDaysAgo(13),
    budget_max: 42000,
    has_trade_in: false,
    location_intent: 'wayne',
  },
];

export const osConversationThreads: ConversationThread[] = [
  {
    id: 'thread-1',
    lead_id: 'lead-os-1',
    location: 'wayne',
    assigned_rep: 'Wayne Sales Desk',
    has_unread: true,
    last_message_at: isoMinutesAgo(19),
  },
  {
    id: 'thread-2',
    lead_id: 'lead-os-6',
    location: 'taylor',
    assigned_rep: 'Taylor Sales Desk',
    has_unread: false,
    last_message_at: isoHoursAgo(9),
  },
  {
    id: 'thread-3',
    lead_id: 'lead-os-5',
    location: 'wayne',
    assigned_rep: 'Ali Almo',
    has_unread: true,
    last_message_at: isoHoursAgo(3),
  },
];

export const osMessageEvents: MessageEvent[] = [
  {
    id: 'msg-1',
    thread_id: 'thread-1',
    lead_id: 'lead-os-1',
    direction: 'inbound',
    channel: 'web_form',
    body: 'My car broke down and I need a reliable Accord by the weekend.',
    created_at: isoMinutesAgo(23),
  },
  {
    id: 'msg-2',
    thread_id: 'thread-1',
    lead_id: 'lead-os-1',
    direction: 'outbound',
    channel: 'sms',
    body: 'Thanks Sarah, I can reserve two options today. Is 5:15 PM good for a test drive?',
    created_at: isoMinutesAgo(16),
    template_key: 'hot_lead_fast_response',
    ai_assist_used: true,
  },
  {
    id: 'msg-3',
    thread_id: 'thread-2',
    lead_id: 'lead-os-6',
    direction: 'outbound',
    channel: 'sms',
    body: 'I can send updated terms if we lock your trade value tonight.',
    created_at: isoHoursAgo(9),
    template_key: 'negotiation_push',
    ai_assist_used: true,
  },
  {
    id: 'msg-4',
    thread_id: 'thread-3',
    lead_id: 'lead-os-5',
    direction: 'inbound',
    channel: 'sms',
    body: 'I can submit docs tonight. Which ones do you still need?',
    created_at: isoHoursAgo(3),
  },
];

export const osCallEvents: CallEvent[] = [
  {
    id: 'call-1',
    lead_id: 'lead-os-1',
    direction: 'inbound',
    outcome: 'missed',
    duration_seconds: 0,
    created_at: isoMinutesAgo(21),
  },
  {
    id: 'call-2',
    lead_id: 'lead-os-6',
    direction: 'outbound',
    outcome: 'answered',
    duration_seconds: 430,
    created_at: isoHoursAgo(11),
  },
  {
    id: 'call-3',
    lead_id: 'lead-os-5',
    direction: 'outbound',
    outcome: 'voicemail',
    duration_seconds: 37,
    created_at: isoHoursAgo(18),
  },
];

export const osOpportunities: OpportunityRecord[] = [
  {
    id: 'opp-1',
    lead_id: 'lead-os-1',
    title: 'Sarah Johnson - Accord urgency',
    stage: 'new',
    expected_value: 22500,
    location: 'wayne',
    assigned_rep: 'Wayne Sales Desk',
    next_action: 'Call within 5 minutes and lock appointment',
    updated_at: isoMinutesAgo(17),
    checklist: { quote_shared: false, docs_requested: false, consent_verified: false },
  },
  {
    id: 'opp-2',
    lead_id: 'lead-os-3',
    title: 'Jessica Williams - SUV switch',
    stage: 'appointment_set',
    expected_value: 26800,
    location: 'wayne',
    assigned_rep: 'Ali Almo',
    next_action: 'Send T-24h reminder and confirm vehicle',
    updated_at: isoHoursAgo(6),
    checklist: { quote_shared: true, docs_requested: false, consent_verified: true },
  },
  {
    id: 'opp-3',
    lead_id: 'lead-os-6',
    title: 'David Thompson - Jeep negotiation',
    stage: 'negotiating',
    expected_value: 31400,
    location: 'taylor',
    assigned_rep: 'Taylor Sales Desk',
    next_action: 'Trade appraisal refresh and payment option',
    updated_at: isoHoursAgo(7),
    checklist: { quote_shared: true, docs_requested: true, consent_verified: true },
  },
  {
    id: 'opp-4',
    lead_id: 'lead-os-5',
    title: 'Emily Martinez - first-time buyer',
    stage: 'financing_review',
    expected_value: 14800,
    location: 'wayne',
    assigned_rep: 'Ali Almo',
    next_action: 'Collect proof of income and residence',
    updated_at: isoHoursAgo(4),
    checklist: { quote_shared: true, docs_requested: true, consent_verified: true },
  },
  {
    id: 'opp-5',
    lead_id: 'lead-os-7',
    title: 'Jennifer Brown - minivan',
    stage: 'closed_won',
    expected_value: 27750,
    location: 'wayne',
    assigned_rep: 'Wayne Sales Desk',
    next_action: 'Request review after delivery check-in',
    updated_at: isoDaysAgo(1),
    checklist: { quote_shared: true, docs_requested: true, consent_verified: true },
  },
];

export const osAppointments: AppointmentRecord[] = [
  {
    id: 'appt-1',
    lead_id: 'lead-os-3',
    location: 'wayne',
    vehicle_label: '2020 Honda CR-V EX',
    starts_at: isoHoursAhead(19),
    status: 'booked',
    created_at: isoHoursAgo(6),
  },
  {
    id: 'appt-2',
    lead_id: 'lead-os-4',
    location: 'taylor',
    vehicle_label: '2019 Toyota Camry XLE',
    starts_at: isoHoursAgo(26),
    status: 'showed',
    created_at: isoDaysAgo(2),
  },
  {
    id: 'appt-3',
    lead_id: 'lead-os-2',
    location: 'taylor',
    vehicle_label: '2021 Ford F-150 Lariat',
    starts_at: isoHoursAgo(8),
    status: 'no_show',
    created_at: isoHoursAgo(30),
  },
];

export const osConsentEvents: ConsentEvent[] = [
  {
    id: 'consent-1',
    lead_id: 'lead-os-3',
    channel: 'sms',
    consented: true,
    source: 'website_form',
    proof: 'form_submission#93484',
    created_at: isoDaysAgo(1),
  },
  {
    id: 'consent-2',
    lead_id: 'lead-os-5',
    channel: 'sms',
    consented: true,
    source: 'finance_form',
    proof: 'finance_submission#66291',
    created_at: isoDaysAgo(3),
  },
];

export const osFinanceApplications: FinanceApplicationRecord[] = [
  {
    id: 'finance-1',
    lead_id: 'lead-os-5',
    status: 'needs_docs',
    completion_percent: 72,
    missing_items: ['Proof of income', 'Proof of residence'],
    started_at: isoDaysAgo(3),
    updated_at: isoHoursAgo(4),
  },
  {
    id: 'finance-2',
    lead_id: 'lead-os-7',
    status: 'approved',
    completion_percent: 100,
    missing_items: [],
    started_at: isoDaysAgo(12),
    updated_at: isoDaysAgo(2),
  },
];

export const osWorkflowDefinitions: WorkflowDefinition[] = [
  {
    id: 'wf-1',
    key: 'new_lead_fast_response',
    name: 'New Lead Fast Response',
    trigger: 'lead.created',
    is_active: true,
    action_count: 5,
  },
  {
    id: 'wf-2',
    key: 'missed_call_text_back',
    name: 'Missed Call Text-Back',
    trigger: 'call.missed',
    is_active: true,
    action_count: 3,
  },
  {
    id: 'wf-3',
    key: 'finance_incomplete_rescue',
    name: 'Finance Incomplete Rescue',
    trigger: 'finance.incomplete',
    is_active: true,
    action_count: 6,
  },
  {
    id: 'wf-4',
    key: 'stale_lead_reactivation_30d',
    name: 'Stale Lead Reactivation 30d',
    trigger: 'lead.stale_30d',
    is_active: true,
    action_count: 4,
  },
];

export const osWorkflowRuns: WorkflowRun[] = [
  {
    id: 'run-1',
    workflow_key: 'new_lead_fast_response',
    lead_id: 'lead-os-1',
    status: 'completed',
    created_at: isoMinutesAgo(16),
    detail: 'SMS + rep task + priority queue label applied',
  },
  {
    id: 'run-2',
    workflow_key: 'finance_incomplete_rescue',
    lead_id: 'lead-os-5',
    status: 'running',
    created_at: isoHoursAgo(2),
    detail: '24h reminder sent, waiting on docs',
  },
];

export const osReviewRequests: ReviewRequestRecord[] = [
  {
    id: 'review-1',
    lead_id: 'lead-os-7',
    status: 'sent',
    channel: 'sms',
    sent_at: isoHoursAgo(14),
  },
  {
    id: 'review-2',
    lead_id: 'lead-os-8',
    status: 'suppressed',
    channel: 'sms',
    suppression_reason: 'Closed lost - no review request',
  },
];
